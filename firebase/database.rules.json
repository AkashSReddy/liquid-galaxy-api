{
  "rules": {
    "up": {
      "$publicIp": {
        ".read": true,
        ".validate": "$publicIp.matches(/^[0-9]{1,3}%[0-9]{1,3}%[0-9]{1,3}%[0-9]{1,3}$/)",
        "$reportUid": {
          ".write": "!data.exists() && newData.exists()",
          ".validate": "newData.hasChildren(['localIp', 'port', 'timestamp'])",
          "localIp": {
            ".validate": "newData.val().matches(/^(10|172|192)\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$/)"
          },
          "port": {
            ".validate": "newData.val() > 0 && newData.val() < 65535"
          },
          "timestamp": {
            ".validate": "newData.val() === now"
          },
          "optional": {
            ".validate": "newData.val().length < 200"
          },
          "$other": {
            ".validate": false
          }
        }
      }
    }
  }
}